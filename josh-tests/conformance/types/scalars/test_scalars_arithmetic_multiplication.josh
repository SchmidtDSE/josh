# @category: types
# @subcategory: scalars
# @priority: high
# @description: Test scalar multiplication and division to create derived compound units (area, volume, density)

start simulation ScalarsArithmeticMultiplication

  grid.size = 1 km
  grid.low.x = 0 m
  grid.low.y = 0 m
  grid.high.x = 1 km
  grid.high.y = 1 km  # 1x1 grid
  grid.patch = "Default"

  steps.low = 0 count
  steps.high = 1 count

end simulation

start patch Default

  # Test area calculation (length * width)
  # Result has compound units "m * m"
  length.init = 4 m
  width.init = 3 m
  area.init = length * width

  # Compare using compound notation
  expectedArea.init = 12 m * 1 m
  assert.areaCalculation.init = area == expectedArea

  # Test volume calculation (area * height)
  # Create base area using compound notation
  baseAreaLength.init = 10 m
  baseAreaWidth.init = 1 m
  baseArea.init = baseAreaLength * baseAreaWidth  # units: "m * m"

  height.init = 2 m
  volume.init = baseArea * height  # units: "m * m * m"

  # Create expected value with matching compound units
  expectedVolume.init = 20 m * 1 m * 1 m
  assert.volumeCalculation.init = volume == expectedVolume

  # Test density calculation (mass / volume)
  mass.init = 100 kg

  # Create container volume using compound notation
  containerLength.init = 10 m
  containerWidth.init = 1 m
  containerHeight.init = 1 m
  containerVolume.init = containerLength * containerWidth * containerHeight  # units: "m * m * m"

  density.init = mass / containerVolume  # units: "kg / (m * m * m)"

  # Create expected density with matching compound units
  expectedDensityNumerator.init = 10 kg
  expectedDensityDenominator.init = 1 m * 1 m * 1 m
  expectedDensity.init = expectedDensityNumerator / expectedDensityDenominator
  assert.densityCalculation.init = density == expectedDensity

  # Test dividing area by length to get width
  # Create total area using compound notation
  totalAreaLength.init = 20 m
  totalAreaWidth.init = 1 m
  totalArea.init = totalAreaLength * totalAreaWidth  # units: "m * m"

  sideLength.init = 4 m
  calculatedWidth.init = totalArea / sideLength  # units: "m * m / m" -> simplifies to "m"
  assert.widthCalculation.init = calculatedWidth == 5 m

end patch

start unit m
  alias meter
  alias meters
end unit

start unit kg
  alias kilogram
  alias kilograms
end unit

start unit km
  alias kilometer
  alias kilometers
end unit

start unit count
end unit

start unit degrees
end unit
